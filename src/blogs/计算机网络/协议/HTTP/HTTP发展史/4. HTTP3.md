# HTTP/3 QUIC 协议
HTTP/2 存在一些比较严重的与 TCP 协议相关的缺陷，但由于 TCP 协议僵化，几乎不可能通过修改 TCP 协议自身来解决这些问题，那么解决问题的思路是绕过 TCP 协议，发明一个 TCP 和 UDP 之外的新的传输协议。

但是这也面临着和修改 TCP 一样的挑战，因为中间设备的僵化，这些设备只认 TCP 和 UDP，如果采用了新的协议，新协议在这些设备同样不被很好地支持。

因此，HTTP/3 选择了一个折衷的方法——UDP 协议，基于 UDP 实现了类似于 TCP 的多路数据流、传输可靠性等功能，我们把这套功能称为 QUIC 协议。关于 HTTP/2 和 HTTP/3 协议栈的比较，可以参考下图：

<img src="https://github.com/zygg1512/myBlog/raw/master/images/计算机网络/http发展史/quic协议.webp" height="300px" />

通过上图我们可以看出，HTTP/3 中的 QUIC 协议集合了以下几点功能
## HTTP/3特点
### 实现了类似 TCP 的流量控制、传输可靠性的功能
虽然 UDP 不提供可靠性的传输，但 QUIC 在 UDP 的基础之上增加了一层来保证数据可靠性传输。它提供了数据包重传、拥塞控制以及其他一些 TCP 中存在的特性。
### 集成了 TLS 加密功能
目前 QUIC 使用的是 TLS1.3，相较于早期版本 TLS1.3 有更多的优点，其中最重要的一点是减少了握手所花费的 RTT 个数。
### 实现了 HTTP/2 中的多路复用功能
**和 TCP 不同，QUIC 实现了在同一物理连接上可以有多个独立的逻辑数据流。实现了数据流的单独传输，就解决了 TCP 中队头阻塞的问题。**

<img src="https://github.com/zygg1512/myBlog/raw/master/images/计算机网络/http发展史/quic通信.webp" />

### 实现了快速握手功能
由于 QUIC 是基于 UDP 的，所以 QUIC 可以实现使用 0-RTT 或者 1-RTT 来建立连接，这意味着 QUIC 可以用最快的速度来发送和接收数据，这样可以大大提升首次打开页面的速度。

## HTTP/3 的挑战
不过要将 HTTP/3 应用到实际环境中比较困难，这些困难点主要来自于以下三个方面。
### 服务器和浏览器端都没有对 HTTP/3 提供比较完整的支持
Chrome 虽然在数年前就开始支持 Google 版本的 QUIC，但是这个版本的 QUIC 和官方的 QUIC 存在着非常大的差异。
### 部署 HTTP/3 也存在着非常大的问题
因为系统内核对 UDP 的优化远远没有达到 TCP 的优化程度，这也是阻碍 QUIC 的一个重要原因。
### 中间设备僵化的问题
这些设备对 UDP 的优化程度远远低于 TCP，据统计使用 QUIC 协议时，大约有 3%～7% 的丢包率。
